<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Counter</title>
    <link rel="stylesheet" href="./css/bootstrap-4.5.0.min.css">
    <link rel="stylesheet" href="./css/style.css">

    <script src="/js/jquery-3.5.1.min.js"></script>
    <script src="/js/bootstrap-4.5.0.min.js"></script>

    <script src="/js/axios-0.19.2.min.js"></script>
    <script src="/js/vue-2.6.11.js"></script>

</head>
<body style="height: 100%">
<div id="app"></div>


<script>
       new Vue({
          el:'#app',
          template:`
            <div class="conteiner">
              <div  style="background-image:url('fundo.jpg');height:100%; background-position: center; background-size:cover; position:fixed; width:100%" >
              
              <div style="top: 50%; left: 50%; transform: translate(-50%,-50%); position: absolute">
                <h1 style="font-size: 32px !important; position: relative; color:white">Entrada: {{ totalA }} <br> Saida: {{ totalB }} <br> </h1>
                <h2 :style="styleObject">Dentroloja: {{ total }} </h2>
                <hr class="w3-border-grey" style="margin:auto;width:100%">
                <button  type="submit" @click="submitProduct" class="btn btn-dark">Reset</button>
               </div>
               <a href="#" class="button" id="button"> Edit</a>
            </div>
            <div class="popup">
               <div class="popup-content">
               <input v-model="max_people" type="text" placeholder="Change-maxpeople" id="nrchange">
               <button  type="submit" @click="maxPeople" class="button">change</button>
               <img src="close.png" alt="Close" class="close">  
               </div>
            </div>`,
         
        
           
          data: {
             totalA:0,
             totalB:0,
             total:0,
             max_people:0,
              styleObject: {
                 color:"white",
                 fontSize: "32px",
                 position: "relative"
               }

          },
          methods: {
             getDados:function(){
           
               var self = this;
               axios.get('/counting')
               .then((response) => {
                  console.log(response);
                  self.totalA = response.data["total"]["enter"]
                  self.totalB = response.data["total"]["exit"]
                  self.total = response.data["total"]["dentro"]
                  self.styleObject.color = response.data["total"]["color"]
               }, (error) => {
                console.log(error);
               });
             },
             //BOTAO POST
             submitProduct: function () {
               var self = this;
               axios.post('/reset',)
               .then((response) => {
               self.getDados();
               }, (error) => {
               console.log(error);
               });
            },

            maxPeople: function () {
               var self = this;
               console.log(this.max_people);
               axios.post('/change',{"maxx":self.max_people})
               .then((response) => {
                  
               
               }, (error) => {
               console.log(error);
               });
            },

               // assuming your response payload is in a data objec

            },
            mounted: function () {
                setInterval(this.getmaxx, 1000);
                setInterval(this.getDados, 1000);



               
          }   
            
      })     

</script>
<script>
   document.getElementById("button").addEventListener("click",function(){
   document.querySelector(".popup").style.display = "flex";
})
   document.querySelector(".close").addEventListener("click",function(){
   document.querySelector(".popup").style.display = "none";

})
</script>

</body>
</html>